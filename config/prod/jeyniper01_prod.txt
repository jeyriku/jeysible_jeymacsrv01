set version 20.3R1.8
set system host-name Jeyniper01
set system root-authentication encrypted-password "$5$ub0EANni$ZZ8MSvNDdGJoDUjTf00q2wqTtZUqnzgo12u7wZrfg.4"
set system login user Jeyriku full-name Jeyriku
set system login user Jeyriku uid 100
set system login user Jeyriku class super-user
set system login user Jeyriku authentication encrypted-password "$5$nSRnDAuu$EhBK6nlwsvoDtHiGR9Ykh6w5RosnMIDsaGL5tj7K5z6"
set system services ssh root-login allow
set system services telnet
set system services xnm-clear-text
set system services netconf ssh
set system services rest https port 4443
set system services rest https addresses 10.0.0.3
set system services rest https server-certificate jeycert
set system services rest enable-explorer
set system auto-snapshot
set system domain-name int.jeyriku.net
set system domain-search int.jeyriku.net
set system time-zone Europe/Paris
set system name-server 192.168.0.252
set system name-server 192.168.0.250
set system syslog archive size 100k
set system syslog archive files 3
set system syslog user * any emergency
set system syslog file messages any critical
set system syslog file messages authorization info
set system syslog file interactive-commands interactive-commands error
set system syslog file kmd-logs daemon info
set system max-configurations-on-flash 5
set system max-configuration-rollbacks 5
set system license autoupdate url https://ae1.juniper.net/junos/key_retrieval
set system ntp server 192.168.0.250
set system ntp server 192.168.0.252
set security forwarding-options family mpls mode packet-based
set interfaces ge-0/0/0 description "Lien vers Jeyniper03"
set interfaces ge-0/0/0 mtu 1614
set interfaces ge-0/0/0 unit 0 description "Lien vers Jeyniper03"
set interfaces ge-0/0/0 unit 0 family inet filter input PCAP
set interfaces ge-0/0/0 unit 0 family inet filter output PCAP
deactivate interfaces ge-0/0/0 unit 0 family inet filter
set interfaces ge-0/0/0 unit 0 family inet address 192.168.12.1/30
set interfaces ge-0/0/0 unit 0 family mpls
set interfaces ge-0/0/1 description "Lien vers Jeyniper04"
set interfaces ge-0/0/1 mtu 1614
set interfaces ge-0/0/1 unit 0 description "Lien vers Jeyniper04"
set interfaces ge-0/0/1 unit 0 family inet address 192.168.12.14/30
set interfaces ge-0/0/1 unit 0 family mpls
set interfaces ge-0/0/2 description "Lien vers Jeyniper02"
set interfaces ge-0/0/2 mtu 1614
set interfaces ge-0/0/2 unit 0 description "Lien vers Jeyniper02"
set interfaces ge-0/0/2 unit 0 family inet address 192.168.12.21/30
set interfaces ge-0/0/2 unit 0 family mpls
set interfaces ge-0/0/3 description "Lien vers Juniper06"
set interfaces ge-0/0/3 mtu 1614
set interfaces ge-0/0/3 unit 0 description "Lien vers Juniper06"
set interfaces ge-0/0/3 unit 0 family inet address 192.168.12.25/30
set interfaces ge-0/0/4 disable
set interfaces ge-0/0/5 description "Lien vers Jeycisco01"
set interfaces ge-0/0/5 flexible-vlan-tagging
set interfaces ge-0/0/5 native-vlan-id 1
set interfaces ge-0/0/5 mtu 1614
set interfaces ge-0/0/5 unit 13 description "Vlan Internet"
set interfaces ge-0/0/5 unit 13 vlan-id 13
set interfaces ge-0/0/5 unit 13 family inet address 192.168.13.1/30
set interfaces ge-0/0/5 unit 16 description "Vlan Admin"
set interfaces ge-0/0/5 unit 16 vlan-id 16
set interfaces ge-0/0/5 unit 16 family inet address 192.168.16.1/30
set interfaces ge-0/0/5 unit 30 description "Vlan Guest"
set interfaces ge-0/0/5 unit 30 vlan-id 30
set interfaces ge-0/0/5 unit 30 family inet address 192.168.30.1/30
set interfaces ge-0/0/6 disable
set interfaces ge-0/0/7 disable
set interfaces lo0 unit 0 family inet address 10.0.0.3/32
set snmp location "int.jeyriku.net, 2 allee des campagnols, Seynod, 74600, Annecy, France [45.85995, 6.0793]"
set snmp community jeyricorp authorization read-only
set snmp community jeyricorp clients 192.168.0.249/32
set snmp trap-options source-address 10.0.0.3
set forwarding-options packet-capture file filename testpacketcapture
set forwarding-options packet-capture maximum-capture-size 1500
set policy-options prefix-list Default 0.0.0.0/0
set policy-options policy-statement Export-static term 1 from protocol static
set policy-options policy-statement Export-static term 1 then accept
set policy-options policy-statement Vrf-Internet-Export term from-Vrf-Internet then community add Rt-Vpn-Internet
set policy-options policy-statement Vrf-Internet-Export term from-Vrf-Internet then accept
set policy-options policy-statement Vrf-Internet-Guest-Export term from-Vrf-Internet-Guest then community add Rt-Vpn-Internet-Guest
set policy-options policy-statement Vrf-Internet-Guest-Export term from-Vrf-Internet-Guest then accept
set policy-options policy-statement Vrf-Internet-Guest-Import term from-Vrf-Internet from community Rt-Vpn-Internet
set policy-options policy-statement Vrf-Internet-Guest-Import term from-Vrf-Internet from prefix-list Default
set policy-options policy-statement Vrf-Internet-Guest-Import term from-Vrf-Internet then accept
set policy-options policy-statement Vrf-Internet-Guest-Import term from-Vrf-Internet-Guest from community Rt-Vpn-Internet-Guest
set policy-options policy-statement Vrf-Internet-Guest-Import term from-Vrf-Internet-Guest then accept
set policy-options policy-statement Vrf-Internet-Import term from-Vrf-Internet from community Rt-Vpn-Internet
set policy-options policy-statement Vrf-Internet-Import term from-Vrf-Internet then accept
set policy-options community Rt-Vpn-Internet members target:65003:01
set policy-options community Rt-Vpn-Internet-Guest members target:65003:03
set firewall filter PCAP term 1 then sample
set firewall filter PCAP term 1 then accept
set firewall filter PCAP term allow-all-else then accept
set routing-instances vpn-internet protocols bgp group external type external
set routing-instances vpn-internet protocols bgp group external family inet unicast
set routing-instances vpn-internet protocols bgp group external neighbor 192.168.13.2 peer-as 65002
set routing-instances vpn-internet interface ge-0/0/5.13
set routing-instances vpn-internet description Internet
set routing-instances vpn-internet instance-type vrf
set routing-instances vpn-internet routing-options autonomous-system 65003
set routing-instances vpn-internet route-distinguisher 10.0.0.3:01
set routing-instances vpn-internet vrf-import Vrf-Internet-Import
set routing-instances vpn-internet vrf-export Vrf-Internet-Export
set routing-instances vpn-internet-guest interface ge-0/0/5.30
set routing-instances vpn-internet-guest instance-type vrf
set routing-instances vpn-internet-guest routing-options static route 192.168.3.0/24 next-hop 192.168.30.2
set routing-instances vpn-internet-guest route-distinguisher 10.0.0.3:03
set routing-instances vpn-internet-guest vrf-import Vrf-Internet-Guest-Import
set routing-instances vpn-internet-guest vrf-export Vrf-Internet-Guest-Export
set protocols ospf area 0.0.0.0 interface ge-0/0/0.0 interface-type p2p
set protocols ospf area 0.0.0.0 interface ge-0/0/0.0 retransmit-interval 5
set protocols ospf area 0.0.0.0 interface ge-0/0/0.0 hello-interval 10
set protocols ospf area 0.0.0.0 interface ge-0/0/0.0 dead-interval 40
set protocols ospf area 0.0.0.0 interface lo0.0 passive
set protocols ospf area 0.0.0.0 interface ge-0/0/1.0 interface-type p2p
set protocols ospf area 0.0.0.0 interface ge-0/0/1.0 retransmit-interval 5
set protocols ospf area 0.0.0.0 interface ge-0/0/1.0 hello-interval 10
set protocols ospf area 0.0.0.0 interface ge-0/0/1.0 dead-interval 40
set protocols ospf area 0.0.0.0 interface ge-0/0/2.0 interface-type p2p
set protocols ospf area 0.0.0.0 interface ge-0/0/2.0 retransmit-interval 5
set protocols ospf area 0.0.0.0 interface ge-0/0/2.0 hello-interval 10
set protocols ospf area 0.0.0.0 interface ge-0/0/2.0 dead-interval 40
set protocols ospf area 0.0.0.0 interface ge-0/0/3.0 interface-type p2p
set protocols ospf area 0.0.0.0 interface ge-0/0/3.0 retransmit-interval 5
set protocols ospf area 0.0.0.0 interface ge-0/0/3.0 hello-interval 10
set protocols ospf area 0.0.0.0 interface ge-0/0/3.0 dead-interval 40
set protocols ospf area 0.0.0.0 interface ge-0/0/5.16 passive
set protocols ospf export Export-static
set protocols bgp group route-reflector type internal
set protocols bgp group route-reflector local-address 10.0.0.3
set protocols bgp group route-reflector family inet unicast add-path receive
set protocols bgp group route-reflector family inet unicast add-path send path-count 6
set protocols bgp group route-reflector family inet-vpn unicast
set protocols bgp group route-reflector family route-target
set protocols bgp group route-reflector neighbor 10.0.0.10
set protocols bgp group route-reflector neighbor 10.0.0.12
set protocols bgp traceoptions file bgp-log
set protocols bgp traceoptions file size 100k
set protocols bgp traceoptions file files 5
set protocols bgp traceoptions file world-readable
set protocols bgp traceoptions flag all send
set protocols bgp traceoptions flag all receive
set protocols bgp traceoptions flag all detail
deactivate protocols bgp traceoptions
set protocols ldp interface ge-0/0/0.0
set protocols ldp interface ge-0/0/1.0
set protocols ldp interface ge-0/0/2.0
set protocols ldp igp-synchronization holddown-interval 15
set protocols mpls interface ge-0/0/0.0
set protocols mpls interface ge-0/0/1.0
set protocols mpls interface ge-0/0/2.0
set protocols lldp interface all
set routing-options rib inet.3 static route 10.0.0.10/32 discard
set routing-options rib inet.3 static route 10.0.0.12/32 discard
set routing-options static route 192.168.0.0/24 next-hop 192.168.16.2
set routing-options static route 192.168.4.0/24 next-hop 192.168.16.2
set routing-options static route 192.168.40.0/24 next-hop 192.168.16.2
set routing-options route-distinguisher-id 10.0.0.3
set routing-options router-id 10.0.0.3
set routing-options autonomous-system 65003
